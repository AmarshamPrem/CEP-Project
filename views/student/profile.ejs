<%- include('../partials/header', { title: "My Profile" }) %>
    <%- include('../partials/navbar', { userType: "student" }) %>

        <h1>Student Profile</h1>

        <div class="profile-info">
            <p><strong>Name:</strong>
                <%= student.name[0].toUpperCase() + student.name.slice(1) %>
            </p>
            <p><strong>ID:</strong>
                <%= student.id %>
            </p>
            <p><strong>Class:</strong>
                <%= student.class %>
            </p>
            <p><strong>Total Books Read:</strong>
                <%= student.booksRead %>
            </p>
            <p><strong>Target Books to Read:</strong>
                <%= student.targetBooks %>
            </p>
        </div>

        <h2>Currently Issued Books</h2>
        <table>
            <thead>
                <tr>
                    <th>Book ID</th>
                    <th>Title</th>
                    <th>Issue Date</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <% if(student.booksIssued.length> 0) { %>
                    <% student.booksIssued.forEach(book=> { %>
                        <tr>
                            <td>
                                <%= book.bookId %>
                            </td>
                            <td>
                                <%= book.title %>
                            </td>
                            <td>
                                <%= book.issueDate %>
                            </td>
                            <td>
                                <% if(book.returned) { %>
                                    ✅ Returned
                                    <% } else { %>
                                        ❌ Not Returned
                                        <% } %>
                            </td>
                        </tr>
                        <% }) %>
                            <% } else { %>
                                <tr>
                                    <td colspan="4">No books currently issued.</td>
                                </tr>
                                <% } %>
            </tbody>
        </table>

        <h2>Reading History</h2>
        <table>
            <thead>
                <tr>
                    <th>Book ID</th>
                    <th>Title</th>
                    <th>Issue Date</th>
                    <th>Return Date</th>
                </tr>
            </thead>
            <tbody>
                <% if(student.history.length> 0) { %>
                    <% student.history.forEach(book=> { %>
                        <tr>
                            <td>
                                <%= book.bookId %>
                            </td>
                            <td>
                                <%= book.title %>
                            </td>
                            <td>
                                <%= book.issueDate %>
                            </td>
                            <td>
                                <%= book.returnDate %>
                            </td>
                        </tr>
                        <% }) %>
                            <% } else { %>
                                <tr>
                                    <td colspan="4">No history found.</td>
                                </tr>
                                <% } %>
            </tbody>
        </table>

        <%- include('../partials/footer') %>